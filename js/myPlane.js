var upBtn=false;var leftBtn=false;var rightBtn=false;var downBtn=false;var shootBtn=false;var bloodBtn=false;var doubleScoreBtn=false;var doubleScoreTimeBtn=false;var bulletArray=[];var supplyArray=[];var supplyTimes=0;function playerPlaneProto(imgSrc,x,y,speed){this.imgNode=document.createElement("img");this.imgSrc=imgSrc;this.x=x;this.y=y;this.speed=speed;this.deadTime=70;this.isDead=false;this.init=function(){this.imgNode.src=this.imgSrc;this.imgNode.style.position="absolute";this.imgNode.style.left=this.x+"px";this.imgNode.style.top=this.y+"px";mainObj.appendChild(this.imgNode)};this.init();this.moveLeft=function(){if(parseInt(this.imgNode.style.left)<-70){this.imgNode.style.left="440px"}else{this.imgNode.style.left=parseInt(this.imgNode.style.left)-this.speed+"px"}};this.moveRight=function(){if(parseInt(this.imgNode.style.left)>437){this.imgNode.style.left="-80px"}else{this.imgNode.style.left=parseInt(this.imgNode.style.left)+this.speed+"px"}};this.moveUp=function(){if(this.imgNode.style.top=="5px"){this.imgNode.style.top="5px"}else{this.imgNode.style.top=parseInt(this.imgNode.style.top)-this.speed+"px"}};this.moveDown=function(){if(this.imgNode.style.top=="536px"){this.imgNode.style.top="536px"}else{this.imgNode.style.top=parseInt(this.imgNode.style.top)+this.speed+"px"}};this.shoot=function(){if(doubleScoreBtn==true){var newBullet=new bulletProto("image/bullet2.png",parseInt(this.imgNode.style.left)+30,parseInt(this.imgNode.style.top)-10,10)}else{var newBullet=new bulletProto("image/bullet1.png",parseInt(this.imgNode.style.left)+30,parseInt(this.imgNode.style.top)-10,10)}bulletArray.push(newBullet)}}document.body.onkeydown=function(){var e=window.event||arguments[0];switch(e.keyCode){case 37:leftBtn=true;break;case 38:upBtn=true;break;case 39:rightBtn=true;break;case 40:downBtn=true;break;case 32:shootBtn=true;break}};document.body.onkeyup=function(){var e=window.event||arguments[0];switch(e.keyCode){case 37:leftBtn=false;break;case 38:upBtn=false;break;case 39:rightBtn=false;break;case 40:downBtn=false;break;case 32:shootBtn=false;break}};function ctrlPlay(){if(leftBtn==true){player.moveLeft()}if(rightBtn==true){player.moveRight()}if(upBtn==true){player.moveUp()}if(downBtn==true){player.moveDown()}if(player.isDead==true){player.deadTime--;if(player.deadTime==0){acpPlayerBlood()}}}function shootPlay(){if(shootBtn==true){player.shoot();bulletMusic.play()}}function bulletMove(){for(var i=0;i<bulletArray.length;i++){bulletArray[i].move();if(parseInt(bulletArray[i].imgNode.style.top)<=10){mainObj.removeChild(bulletArray[i].imgNode);bulletArray.splice(i,1)}}}function crashCheck(){for(var i=0;i<smallPlaneArray.length;i++){for(var j=0;j<bulletArray.length;j++){var btLeft=parseInt(bulletArray[j].imgNode.style.left);var btTop=parseInt(bulletArray[j].imgNode.style.top);var eplLeft=parseInt(smallPlaneArray[i].imgNode.style.left);var eplTop=parseInt(smallPlaneArray[i].imgNode.style.top);if(btLeft>=eplLeft&&btLeft<=eplLeft+34&&btTop>=eplTop&&btTop<eplTop+24){mainObj.removeChild(bulletArray[j].imgNode);bulletArray.splice(j,1);if(changeBgImageBtn==1){smallPlaneArray[i].imgNode.src="image/smallplan2.gif"}else{if(changeBgImageBtn==2){smallPlaneArray[i].imgNode.src="image/smallplan3.gif"}else{smallPlaneArray[i].imgNode.src="image/smallplan.gif"}}smallPlaneArray[i].isDead=true}}}for(var i=0;i<2;i++){for(var j=0;j<bigBulletArray[i].length;j++){var btLeft=parseInt(bigBulletArray[i][j].imgNode.style.left);var btTop=parseInt(bigBulletArray[i][j].imgNode.style.top);var playerLeft=parseInt(player.imgNode.style.left);var playerTop=parseInt(player.imgNode.style.top);if((btLeft>=playerLeft&&btLeft+10<=playerLeft+66&&btTop>=playerTop-26&&btTop<playerTop+82)||(btTop>=playerTop&&btTop+26<=playerTop+82&&btLeft>=playerLeft-10&&btLeft<=playerLeft+66)){mainObj.removeChild(bigBulletArray[i][j].imgNode);bigBulletArray[i].splice(j,1);if(doubleScoreBtn==true){player.imgNode.src="image/supplyPlaneDead.gif"}else{player.imgNode.src="image/hero_blowup.gif"}player.speed=0;bloodBtn=true;player.isDead=true}}}for(var i=0;i<bigPlaneArray.length;i++){for(var j=0;j<bulletArray.length;j++){var btLeft=parseInt(bulletArray[j].imgNode.style.left);var btTop=parseInt(bulletArray[j].imgNode.style.top);var eplLeft=parseInt(bigPlaneArray[i].imgNode.style.left);var eplTop=parseInt(bigPlaneArray[i].imgNode.style.top);if(bloodBtn==false){if(btLeft>=eplLeft&&btLeft<=eplLeft+128&&btTop>=eplTop&&btTop<eplTop+128){mainObj.removeChild(bulletArray[j].imgNode);bulletArray.splice(j,1);if(bigPlaneArray[i].bloods!=0){bigPlaneArray[i].bloods--}else{if(changeBgImageBtn==1){bigPlaneArray[i].imgNode.src="image/bigPlane2.gif"}else{if(changeBgImageBtn==2){bigPlaneArray[i].imgNode.src="image/bigPlane3.gif"}else{bigPlaneArray[i].imgNode.src="image/bigPlane.gif"}}bigPlaneArray[i].isDead=true}}}}}for(var k=0;k<smallPlaneArray.length;k++){var playerLeft=parseInt(player.imgNode.style.left);var playerTop=parseInt(player.imgNode.style.top);var eplLeft=parseInt(smallPlaneArray[k].imgNode.style.left);
var eplTop=parseInt(smallPlaneArray[k].imgNode.style.top);if(bloodBtn==false){if((eplLeft>=playerLeft&&eplLeft<=playerLeft+40&&eplTop>=playerTop-14&&eplTop<=playerTop+56)||(eplTop>=playerTop&&eplTop<=playerTop+62&&eplLeft>=playerLeft-12&&eplLeft<=playerLeft+50)){if(changeBgImageBtn==1){smallPlaneArray[k].imgNode.src="image/smallplan2.gif"}else{if(changeBgImageBtn==2){smallPlaneArray[k].imgNode.src="image/smallplan3.gif"}else{smallPlaneArray[k].imgNode.src="image/smallplan.gif"}}if(doubleScoreBtn==true){player.imgNode.src="image/supplyPlaneDead.gif"}else{player.imgNode.src="image/hero_blowup.gif"}player.speed=0;bloodBtn=true;smallPlaneArray[k].isDead=true}}}for(var k=0;k<bigPlaneArray.length;k++){var playerLeft=parseInt(player.imgNode.style.left);var playerTop=parseInt(player.imgNode.style.top);var eplLeft=parseInt(bigPlaneArray[k].imgNode.style.left);var eplTop=parseInt(bigPlaneArray[k].imgNode.style.top);if(bloodBtn==false){if((playerLeft>=eplLeft&&playerLeft+66<=eplLeft+128&&playerTop>=eplTop-60&&playerTop<=eplTop+100)||(playerTop>=eplTop&&playerTop+82<=eplTop+128&&playerLeft>=eplLeft-40&&playerLeft<=eplLeft+80)){if(changeBgImageBtn==1){bigPlaneArray[k].imgNode.src="image/bigPlane2.gif"}else{if(changeBgImageBtn==2){bigPlaneArray[k].imgNode.src="image/bigPlane3.gif"}else{bigPlaneArray[k].imgNode.src="image/bigPlane.gif"}}if(doubleScoreBtn==true){player.imgNode.src="image/supplyPlaneDead.gif"}else{player.imgNode.src="image/hero_blowup.gif"}player.speed=0;bloodBtn=true;bigPlaneArray[k].isDead=true}}}for(var l=0;l<supplyArray.length;l++){var playerLeft=parseInt(player.imgNode.style.left);var playerTop=parseInt(player.imgNode.style.top);var splLeft=parseInt(supplyArray[l].imgNode.style.left);var splTop=parseInt(supplyArray[l].imgNode.style.top);if(doubleScoreTimeBtn==false){if((splLeft>=playerLeft&&splLeft<=playerLeft+40&&splTop>=playerTop-14&&splTop<=playerTop+56)||(splTop>=playerTop&&splTop<=playerTop+62&&splLeft>=playerLeft-12&&splLeft<=playerLeft+50)){supplyIcon.style.display="block";supplyMusic.play();doubleScoreBtn=true;doubleScoreTimeBtn=true;supplyTimes+=20;supplyTime.innerHTML=supplyTimes+"秒";supplyArray[l].isEat=true;supplyArray[l].imgNode.src="image/supplyEat.gif";player.imgNode.src="image/XPlane.png"}}}}function supplyTimeSub(){if(doubleScoreBtn==true){supplyTimes--;supplyTime.innerHTML=supplyTimes+"秒"}if(supplyTimes<0){supplyIcon.style.display="none";doubleScoreBtn=false;player.imgNode.src="image/my-plane.gif"}};